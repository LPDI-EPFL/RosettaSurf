#!/bin/bash
#SBATCH --nodes 1
#SBATCH --ntasks-per-node 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 8192
#SBATCH --time 24:00:00
#SBATCH --partition serial
#SBATCH --output=./gly.%A_%a.out
#SBATCH --error=./gly.%A_%a.err

pdb_id=("3GJ6_A_B" "2PTC_E_I" "2B12_A_B" "4XNY_HL_G" "3LIZ_HL_A" "1ZHH_A_B" "4HEP_A_G" "3ZEU_D_E" "3V6B_A_R" "4BWQ_E_F" "3LEV_L_H" "4PJ2_A_D" "1Y64_A_B" "5F9O_HL_G" "4KVN_HL_A" "2PTC_E_I" "1SMF_E_I" "4Y5Y_DE_F" "3OJM_A_B" "4XVT_HL_G" "4TSC_HL_A" "1S1Q_A_B" "4IOP_A_B" "4YFL_FI_E" "2XPX_A_B" "3R1G_HL_B" "1W1W_B_F" "2Y5B_A_B" "1OYV_B_I" "5DMI_HL_A" "5K8Q_A_B" "1Y64_A_B" "3WKT_A_C" "1OP9_A_B" "2PSM_A_F" "4HFU_HL_A" "4EDX_HL_V" "4F9P_A_B" "4OM1_HL_G" "1JK9_B_A" "3TT1_HL_B" "1YVB_A_I" "5TH9_HL_A" "4RWY_HL_A" "3H8K_A_B" "4OM1_HL_G" "5VJQ_GH_L" "5H35_FG_E" "2UZI_HL_R" "3P95_A_E" "3VG9_CB_A" "1R0R_E_I" "3NCC_A_B" "4QRP_K_L" "1FAK_HL_T" "1ZLI_A_B" "3O6B_A_B" "2R9P_A_E" "2B12_A_B" "3MA2_D_C" "4V0N_D_C" "5TZU_HL_C" "1TMQ_A_B" "5HVG_A_B" "1ZHI_A_B" "3M18_A_B" "1J2J_A_B" "5D1Z_DC_I" "4MI8_A_C" "4HT1_HL_T" "2MCN_A_B" "4UDM_B_A" "2A6D_L_H" "4S1R_HL_G" "2M5B_A_B" "3RGV_A_B" "4C9B_A_B" "2ES4_A_D" "3LEV_L_H" "1FSK_BC_A" "5AJJ_A_B" "4M5F_A_B" "2LFW_A_B" "4HCP_A_B" "2YVJ_A_B" "2P44_A_B" "1WEJ_HL_F" "4JEH_A_B" "5UG0_DC_A" "3DI2_A_B" "2MZD_A_B" "4FFY_HL_A" "4C9B_A_B" "4QRP_K_L" "2LQH_A_B" "4N7Z_A_B" "1TE1_A_B" "1TH1_A_C" "1TZI_BA_V" "3SGB_E_I" "1Y1K_E_I" "3BP8_AB_C" "6BDZ_HL_A" "1TE1_A_B" "4LST_HL_G" "1G9I_E_I" "1Y4D_E_I" "3VLB_A_B" "2MRO_A_B" "1H0D_BA_C" "3CX8_A_B" "4HGK_A_D" "2X9A_D_C" "3TGK_E_I" "3WO3_A_B" "3TSR_A_E" "1NW9_B_A" "1LDT_T_L" "5WB9_HL_G" "3O2D_HL_A" "1PKQ_GF_J" "6CMG_CB_A" "3AU4_A_B" "2OMY_A_B" "1Y1K_E_I" "4F0A_A_B" "5D96_JI_D" "2L0F_A_B" "1XD3_A_B" "2FTL_E_I" "5K9O_HL_I" "6AZZ_CB_A" "1AVA_A_C" "2G2U_A_B" "4S1R_HL_G" "3H6S_A_E" "2ES4_A_D" "3BN9_FE_A" "1BVN_P_T" "5TRU_HL_C" "2B2X_HL_A" "2NYZ_AB_D" "3AAA_AB_C" "4WEN_A_B" "1MCV_A_I" "5W08_OP_E" "5W6G_HL_A" "2JEL_HL_P" "3WQB_A_B" "4LAD_A_B" "4LSU_HL_G" "2SNI_E_I" "1TM4_E_I" "1B27_A_D" "2FTL_E_I" "4YDK_HL_G" "5XBM_BA_C" "5J57_A_B" "4LVN_CB_A" "4K0A_A_R" "1YRT_A_B" "4HF5_HL_A" "2Y8T_A_B" "1B27_A_D" "1VFB_AB_C" "3C9A_B_D" "3OIQ_A_B" "3QUM_KM_Q" "4S1S_HL_G" "1EZU_C_AB" "2OT3_B_A" "3FII_A_B" "3K1R_A_B" "1ZJD_A_B" "1YC0_A_I" "1A2Y_BA_C" "2LFW_A_B" "2OT8_A_C" "4KT3_A_B" "4PLO_B_A" "5HPY_A_B" "2VH5_HL_R" "4QVF_A_B" "2B42_B_A" "1BGX_HL_T" "3KJ4_HL_A" "1VG0_A_B" "2A6D_L_H" "1SYX_A_B" "4DKF_HL_A" "4Y5V_DE_F" "2J7P_A_D" "4TNW_IO_D" "4RT6_A_B" "2LQH_A_B" "4QLP_A_B" "2AQ3_A_B" "2G81_E_I" "3UYP_A_B" "4HC1_MN_B")
chains1=("A" "I" "B" "H,L" "A" "B" "A" "D" "R" "F" "H" "D" "A" "G" "H,L" "E" "E" "D,E" "B" "G" "H,L" "A" "A" "E" "B" "H,L" "B" "A" "B" "A" "A" "A" "A" "A" "F" "H,L" "V" "B" "G" "A" "H,L" "I" "H,L" "H,L" "A" "G" "L" "F,G" "H,L" "E" "C,B" "E" "B" "L" "H,L" "B" "B" "E" "A" "D" "D" "H,L" "B" "B" "A" "A" "A" "D,C" "A" "H,L" "B" "A" "H" "H,L" "B" "B" "B" "A" "L" "B,C" "B" "A" "A" "A" "B" "A" "F" "B" "A" "A" "A" "A" "B" "L" "B" "B" "B" "A" "B,A" "E" "E" "C" "H,L" "B" "G" "E" "E" "A" "A" "B,A" "B" "A" "D" "I" "A" "A" "A" "T" "G" "H,L" "G,F" "A" "A" "B" "E" "B" "D" "A" "A" "E" "I" "A" "C" "B" "G" "E" "A" "F,E" "P" "H,L" "A" "A,B" "A,B" "A" "A" "O,P" "H,L" "H,L" "A" "A" "G" "I" "E" "D" "E" "H,L" "C" "B" "A" "A" "A" "A" "B" "D" "C" "D" "A" "K,M" "G" "A,B" "B" "A" "A" "B" "A" "B,A" "B" "C" "A" "B" "A" "H,L" "A" "A" "H,L" "A" "B" "L" "A" "H,L" "D,E" "A" "I,O" "A" "B" "B" "A" "E" "A" "M,N")
chains2=("B" "E" "A" "G" "H,L" "A" "G" "E" "A" "E" "L" "A" "B" "H,L" "A" "I" "I" "F" "A" "H,L" "A" "B" "B" "F,I" "A" "B" "F" "B" "I" "H,L" "B" "B" "C" "B" "A" "A" "H,L" "A" "H,L" "B" "B" "A" "A" "A" "B" "H,L" "G,H" "E" "R" "A" "A" "I" "A" "K" "T" "A" "A" "A" "B" "C" "C" "C" "A" "A" "B" "B" "B" "I" "C" "T" "A" "B" "L" "G" "A" "A" "A" "D" "H" "A" "A" "B" "B" "B" "A" "B" "H,L" "A" "D,C" "B" "B" "H,L" "A" "K" "A" "A" "A" "C" "V" "I" "I" "A,B" "A" "A" "H,L" "I" "I" "B" "B" "C" "A" "D" "C" "E" "B" "E" "B" "L" "H,L" "A" "J" "C,B" "B" "A" "I" "A" "J,I" "B" "B" "I" "H,L" "C,B" "A" "A" "H,L" "A" "D" "A" "T" "C" "H,L" "D" "C" "B" "I" "E" "A" "P" "B" "B" "H,L" "E" "I" "A" "I" "G" "B,A" "A" "C,B" "R" "B" "H,L" "A" "A" "A,B" "B" "B" "Q" "H,L" "C" "A" "B" "B" "A" "I" "C" "A" "A" "B" "A" "B" "R" "B" "B" "T" "H,L" "A" "H" "B" "A" "F" "D" "D" "B" "A" "A" "B" "I" "B" "B")
mut_res=("78A" "36I" "77B" "97L" "236A" "180B" "32A" "84D" "196R" "249F" "106H" "96D" "146A" "429G" "50L" "193E" "193E" "103D" "316B" "459G" "98H" "107A" "144A" "471E" "72B" "31H" "22B" "471A" "102B" "63A" "59A" "23A" "89A" "100A" "39F" "55H" "23V" "127B" "367G" "150A" "54H" "57I" "54H" "55H" "23A" "473G" "16L" "28F" "99H" "36E" "93B" "102E" "138B" "47L" "78L" "44B" "808B" "37E" "192A" "197D" "398D" "33H" "610B" "31B" "64A" "214A" "50A" "109D" "86A" "100H" "10B" "30A" "135H" "56H" "94B" "40B" "131B" "294A" "100L" "99C" "94B" "187A" "4A" "210A" "53B" "112A" "37F" "227B" "143A" "85A" "6A" "383A" "130B" "182L" "125B" "238B" "129B" "422A" "55B" "172E" "128E" "66C" "121H" "21B" "458G" "216E" "154E" "324A" "47A" "53B" "443B" "328A" "341D" "37I" "59A" "89A" "305A" "193T" "458G" "56H" "95G" "506A" "2003A" "15B" "154E" "188B" "143D" "47A" "155A" "193E" "349I" "110A" "105C" "158B" "459G" "22E" "77A" "92E" "309P" "30L" "221A" "83B" "140B" "56A" "190A" "109O" "32L" "97H" "512A" "27A" "472G" "83I" "128E" "44D" "142E" "55H" "399C" "114B" "395A" "366A" "339A" "135A" "1307B" "32D" "117C" "90D" "137A" "29M" "458G" "68A" "28B" "53A" "104A" "36B" "541A" "31B" "29B" "57C" "146A" "803B" "238A" "99H" "138A" "294A" "26H" "95A" "42B" "101L" "122A" "54H" "103D" "108A" "57I" "767A" "130B" "732B" "51A" "216E" "165A" "30N")

for i in {0..200}
do
    srun /PATH_TO_ROSETTA/source/bin/rosetta_scripts.default.linuxiccrelease -parser:protocol recovery.xml -ignore_unrecognized_res -out:file:score_only recover_gly.sc -s ${pdb_id[$i]}.pdb -parser:script_vars c1=${chains1[$i]} c2=${chains2[$i]} r=${mut_res[$i]} -out:no_nstruct_label -mute core.scoring.sc.ShapeIdentityCalculator -in:file:native ${pdb_id[$i]}.pdb
done
    
