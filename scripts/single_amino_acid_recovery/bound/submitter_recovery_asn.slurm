#!/bin/bash
#SBATCH --nodes 1
#SBATCH --ntasks-per-node 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 8192
#SBATCH --time 24:00:00
#SBATCH --partition serial
#SBATCH --output=./asn.%A_%a.out
#SBATCH --error=./asn.%A_%a.err

pdb_id=("3GS2_A_B" "3WO3_A_B" "5TFW_HL_O" "3UL1_B_A" "4RGN_FG_S" "2LQH_A_B" "4BD9_A_B" "3H6S_A_E" "3NCB_A_B" "5DC4_A_B" "2ADF_HL_A" "2B12_A_B" "1TMQ_A_B" "4M5F_A_B" "4YEB_A_B" "4FFV_DC_B" "5VYF_HL_F" "3IFQ_A_C" "1LP1_A_B" "2XNS_B_D" "3ZJY_E_D" "1I2M_A_B" "5D93_CB_A" "4AG2_A_C" "5EB1_A_B" "1NCB_HL_N" "4WEM_A_B" "3F7P_A_C" "4LSP_HL_G" "2C0L_A_B" "4M0W_A_B" "1Z92_A_B" "1ZMY_A_L" "1ES0_A_B" "4POU_A_B" "6BF4_BC_A" "1ZHI_A_B" "3UKX_B_C" "4TNW_IO_D" "4PEQ_A_B" "5W0K_HL_A" "3O34_A_B" "5OB5_HL_A" "6B0G_DC_E" "5VL7_HL_B" "5TFW_HL_O" "3WN7_A_B" "4CDK_A_E" "4HKX_AB_E" "2R0L_HL_A" "3FMG_HL_A" "1ZVY_A_B" "1DJS_A_B" "4MXV_FE_B" "1KXP_A_D" "1J7D_A_B" "4D0N_A_B" "4A1S_B_E" "3F50_A_B" "2P42_A_B" "3BSZ_NM_E" "3WRX_A_C" "4RT6_A_B" "2R0K_HL_A" "1RJC_A_B" "2Z8W_A_D" "4GAF_B_A" "3U82_A_B" "2XHE_A_B" "3GI9_HL_C" "3OLM_A_D" "3PNR_A_B" "4NZR_HL_M" "2G77_A_B" "3D9A_HL_C" "4U0Q_A_B" "4IYP_A_C" "6ATT_HL_A" "5D1K_A_B" "4QXA_A_B" "4JR9_HL_A" "4FT4_B_Q" "5TIH_HL_A" "1XG2_A_B" "1JTD_B_A" "5D96_JI_D" "4MIT_A_E" "3PVM_A_B" "2VE7_A_C" "2CFH_A_C" "4PAS_A_B" "5CUS_HL_A" "4S1R_HL_G" "1DFJ_E_I" "3WWN_A_B" "4YIZ_A_B" "6BP2_HL_A" "4GLV_A_B" "2OT8_A_C" "3RO2_A_B" "5D3I_A_B" "4CNI_HL_C" "2MLZ_B_A" "4K24_A_U" "2OMY_A_B" "4K5B_D_A" "4ENE_EF_B" "4NIQ_A_C" "1ADQ_HL_A" "5DFV_EF_B" "5VL7_HL_B" "4JS0_A_B" "4YDL_HL_G" "3SO3_CB_A" "4JEU_A_B" "4Z5R_BA_N" "4CJ2_B_C" "2OT3_B_A" "3M18_A_B" "5JHL_HL_A" "3TT3_HL_A" "3GNI_A_B" "3QHY_A_B" "3UL1_B_A" "1I4D_D_AB" "3O2D_HL_A" "4J6R_HL_G" "3OXU_B_F" "4C9B_A_B" "4YOC_A_C" "4GLV_A_B" "1F51_AB_E" "6B0G_DC_E" "3ZYJ_A_B" "4S1R_HL_G" "1CLV_A_I" "3SE9_HL_G" "1FBI_HL_X" "5SZH_A_B" "1I2M_A_B" "1EWY_A_C" "1XD3_A_B" "1ZLI_A_B" "4YE4_HL_G" "1ZHI_A_B" "3QBR_A_B" "1TA3_A_B" "4C4P_A_B" "2VIR_AB_C" "5CMN_A_E" "1LFD_B_A" "2C0L_A_B" "3AAD_A_B" "4YDL_HL_G" "3OUX_A_B" "4JCV_ADBC_E" "3VG9_CB_A" "2OMX_A_B" "3OHM_A_B" "6AOD_BA_C" "1B6C_A_B" "4DJ9_A_B" "4XNQ_BA_D" "3WWN_A_B" "3GNI_A_B" "1WEJ_HL_F" "2A5T_A_B" "2I3S_A_B" "5UEM_HL_G" "1OSP_HL_O" "3NH7_KO_D" "1L0Y_A_B" "1V18_A_B" "3KS0_HL_B" "2J88_HL_A" "4PW9_A_B" "1GP2_A_BG" "2WJV_A_D" "5K8Q_A_B" "3RGV_A_B" "4JEH_A_B" "3V4Y_A_B" "4EXP_A_X" "5ET1_A_C" "2B4J_AB_C" "4MYW_A_B" "3SRI_A_B" "4RE1_A_D" "4A1S_B_E" "1TDQ_A_B" "5J4A_A_B" "1Y6N_L_R" "3G6J_E_F" "2OMU_A_B" "2NR6_FE_B" "2VLQ_A_B" "3MAC_HL_A" "2A7U_A_B" "4I77_HL_Z" "4EKD_A_B")
chains1=("A" "B" "O" "B" "S" "B" "B" "E" "A" "B" "H,L" "A" "A" "A" "B" "D,C" "F" "A" "B" "B" "D" "A" "A" "A" "A" "N" "B" "A" "H,L" "A" "A" "B" "A" "B" "A" "B,C" "A" "B" "D" "B" "H,L" "A" "H,L" "D,C" "H,L" "O" "A" "A" "E" "H,L" "H,L" "A" "B" "B" "D" "A" "A" "B" "B" "A" "N,M" "C" "A" "A" "B" "A" "A" "B" "B" "C" "A" "A" "H,L" "A" "C" "A" "C" "H,L" "A" "B" "H,L" "B" "A" "B" "B" "D" "A" "A" "A" "A" "B" "A" "G" "I" "A" "A" "H,L" "A" "C" "A" "B" "C" "A" "A" "A" "D" "E,F" "C" "A" "B" "H,L" "A" "H,L" "A" "A" "B,A" "B" "B" "B" "H,L" "H,L" "B" "B" "B" "A,B" "H,L" "G" "B" "B" "C" "A" "A,B" "E" "A" "H,L" "A" "G" "X" "B" "B" "A" "A" "A" "H,L" "A" "A" "B" "B" "A,B" "E" "A" "A" "B" "G" "A" "A,D,B,C" "C,B" "A" "B" "B,A" "B" "A" "B,A" "A" "A" "H,L" "B" "A" "G" "O" "K,O" "B" "A" "H,L" "H,L" "B" "B,G" "A" "A" "A" "B" "B" "A" "A" "C" "A" "A" "A" "B" "B" "A" "R" "E" "A" "F,E" "A" "H,L" "B" "H,L" "B")
chains2=("B" "A" "H,L" "A" "F,G" "A" "A" "A" "B" "A" "A" "B" "B" "B" "A" "B" "H,L" "C" "A" "D" "E" "B" "C,B" "C" "B" "H,L" "A" "C" "G" "B" "B" "A" "L" "A" "B" "A" "B" "C" "I,O" "A" "A" "B" "A" "E" "B" "H,L" "B" "E" "A,B" "A" "A" "B" "A" "F,E" "A" "B" "B" "E" "A" "B" "E" "A" "B" "H,L" "A" "D" "B" "A" "A" "H,L" "D" "B" "M" "B" "H,L" "B" "A" "A" "B" "A" "A" "Q" "H,L" "A" "A" "J,I" "E" "B" "C" "C" "A" "H,L" "H,L" "E" "B" "B" "A" "B" "A" "B" "A" "H,L" "B" "U" "B" "A" "B" "A" "H,L" "E,F" "B" "B" "G" "C,B" "B" "N" "C" "A" "A" "A" "A" "A" "A" "A" "D" "A" "H,L" "F" "A" "A" "B" "E" "D,C" "B" "G" "I" "H,L" "H,L" "A" "A" "C" "B" "B" "G" "B" "B" "A" "A" "C" "A" "B" "B" "A" "H,L" "B" "E" "A" "B" "A" "C" "A" "B" "D" "B" "B" "F" "A" "B" "H,L" "H,L" "D" "A" "B" "B" "A" "A" "A" "D" "B" "B" "A" "A" "X" "C" "A,B" "B" "B" "D" "E" "A" "B" "L" "F" "B" "B" "B" "A" "A" "Z" "A")
mut_res=("322A" "212B" "125O" "188B" "151S" "108B" "57B" "128E" "198A" "85B" "31H" "208A" "331A" "273A" "45B" "33D" "21F" "599A" "28B" "149B" "103D" "103A" "145A" "82A" "90A" "400N" "858B" "146A" "54H" "534A" "110A" "27B" "52A" "98B" "113A" "29C" "117A" "188B" "196D" "402B" "32L" "980A" "31H" "30C" "54H" "119O" "414A" "110A" "158E" "31H" "60H" "57A" "7B" "62B" "451D" "12A" "41A" "226B" "31B" "71A" "34M" "978C" "788A" "98A" "113B" "205A" "14A" "77B" "155B" "430C" "538A" "81A" "77L" "381A" "703C" "352A" "139C" "104H" "11A" "298B" "52H" "260B" "116A" "77B" "304B" "117D" "46A" "527A" "272A" "50A" "795B" "274A" "279G" "402I" "42A" "184A" "58H" "103A" "59C" "203A" "174B" "103C" "225A" "22A" "321A" "103D" "59E" "183C" "384A" "172B" "58H" "39A" "58H" "95A" "134A" "52B" "103B" "69B" "39B" "60H" "55H" "126B" "304B" "146B" "108A" "98H" "279G" "170B" "167B" "741C" "46A" "34A" "115E" "203A" "58H" "137A" "276G" "77X" "2B" "150B" "13A" "223A" "14A" "105H" "120A" "101A" "131B" "483B" "56B" "282E" "29A" "568A" "7B" "280G" "387A" "115C" "53B" "128A" "861B" "59B" "267B" "53A" "57B" "192A" "104A" "50L" "118B" "101A" "280G" "70O" "52O" "20B" "387A" "96L" "50L" "82B" "88B" "263A" "53A" "92A" "236B" "211B" "128A" "171A" "367C" "227A" "223A" "349A" "346B" "111B" "267A" "94R" "137E" "128A" "55F" "24A" "103H" "74B" "30L" "109B")

for i in {0..200}
do
    srun /PATH_TO_ROSETTA/source/bin/rosetta_scripts.default.linuxiccrelease -parser:protocol recovery.xml -ignore_unrecognized_res -out:file:score_only recover_asn.sc -s ${pdb_id[$i]}.pdb -parser:script_vars c1=${chains1[$i]} c2=${chains2[$i]} r=${mut_res[$i]} -out:no_nstruct_label -mute core.scoring.sc.ShapeIdentityCalculator -in:file:native ${pdb_id[$i]}.pdb
done
    
