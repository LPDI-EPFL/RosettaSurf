#!/bin/bash
#SBATCH --nodes 1
#SBATCH --ntasks-per-node 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 8192
#SBATCH --time 24:00:00
#SBATCH --partition serial
#SBATCH --output=./val.%A_%a.out
#SBATCH --error=./val.%A_%a.err

pdb_id=("3SF4_A_D" "3BP8_AB_C" "4V0M_F_E" "4NP4_HL_A" "1T01_A_B" "3CX5_JK_E" "5KVF_HL_E" "4FFY_HL_A" "2GWW_A_B" "3S9D_B_A" "2ES4_A_D" "5D1K_A_B" "5EP6_A_B" "6BIT_JL_G" "1I2M_A_B" "1EER_A_BC" "2LZ6_A_B" "5CUS_HL_A" "4K24_A_U" "2WO2_A_B" "3R9A_AC_B" "4RE1_A_D" "2Y8S_A_B" "1AN1_E_I" "3QQ8_A_B" "2AQ1_A_B" "6B0A_HL_A" "4HCP_A_B" "3VYR_A_B" "5D1M_A_B" "5IP4_A_E" "4BFI_A_B" "4OFY_A_D" "2B7C_A_B" "3EO1_AB_CF" "4DOQ_A_B" "4NE9_A_P" "3GJ7_A_B" "2DD8_H_L" "5AGW_B_C" "5TIH_HL_A" "3D5R_A_C" "2OZA_B_A" "4YIZ_A_B" "4C9B_A_B" "1PVH_A_B" "3L89_ABC_M" "5HBT_DC_B" "3BN3_A_B" "1DPJ_A_B" "3WKM_IM_B" "1BGX_HL_T" "4IDJ_HL_A" "2OMW_A_B" "2MV7_A_B" "3FIE_A_C" "5BOZ_A_G" "5EE5_A_B" "6B08_CB_A" "2LKM_A_B" "4RWT_A_D" "2UYZ_A_B" "1G9M_HL_G" "1ATN_A_D" "1P27_A_B" "4Q5U_A_C" "2AYO_A_B" "5SX5_HL_N" "3PVM_A_B" "4LAD_A_B" "2YC1_AB_C" "2PTC_E_I" "3GC3_A_B" "2A78_A_B" "2VOG_A_B" "3PC8_A_C" "4DH2_A_B" "1WQJ_B_I" "5CZX_HL_A" "3WKM_IM_B" "3K6G_A_D" "4GH7_A_B" "1KXQ_H_A" "1R8S_A_E" "4NE9_A_P" "1F7Z_A_I" "2XTT_A_B" "2OZA_B_A" "1SHY_A_B" "4NOO_A_B" "5XXY_HL_A" "1G6V_A_K" "1P69_A_B" "3MAC_HL_A" "5K8Q_A_B" "2J0T_A_D" "1P27_A_B" "3L9J_C_T" "3FIE_A_C" "3DVM_A_B" "4H6J_A_B" "3SGK_A_B" "1OEY_A_J" "4KT1_A_E" "2GTP_A_D" "3GQI_A_B" "1PVH_A_B" "2J12_A_B" "4DJ9_A_B" "3EOA_LH_I" "6BPA_BC_A" "2JJS_A_C" "2WEL_A_D" "3NH7_KO_D" "4BKX_A_B" "1IJK_A_BC" "2M0G_A_B" "2MRE_A_B" "1P6A_A_B" "4XOI_A_B" "3FP6_E_I" "3V3K_A_B" "3QWQ_A_B" "4ILW_A_D" "4ZQU_A_B" "4K9E_HL_C" "2LOX_A_B" "2Y8S_A_B" "1NVU_Q_S" "2MLX_B_A" "4XNZ_EF_D" "2MLX_B_A" "1ADQ_HL_A" "3KJ2_A_B" "3W8H_A_B" "3QC8_A_B" "6B0A_HL_A" "4YIZ_A_B" "1OGY_A_B" "4IC7_A_B" "1CGI_E_I" "3ZEU_D_E" "5K9O_HL_I" "4L0P_A_B" "3QUM_KM_Q" "2GWW_A_B" "3SUA_A_D" "5FZT_A_B" "2QHO_A_B" "4HFF_A_B" "1RLB_ABCD_E" "3ZKQ_A_D" "4QT8_A_C" "2BQZ_A_B" "5IJ9_A_B" "1EAW_A_B" "5VIC_HL_E" "2I26_N_L" "5W0D_BC_A" "5GLH_A_B" "1RKC_A_B" "1XT9_A_B" "1UJ3_BA_C" "4IU3_A_B" "4CDK_A_E" "3V7A_EH_A" "3W9E_AB_C" "3G6D_LH_A" "1M5N_S_Q" "2W84_A_B" "2YGG_A_B" "4GNK_A_B" "1HCF_AB_X" "4ZII_A_C" "1UUZ_A_D" "4C5G_A_B" "4G6J_HL_A" "3UZE_A_C" "3MAC_HL_A" "4YIZ_A_B" "3TAC_A_B" "1TE1_A_B" "2LD7_A_B" "1L4D_A_B" "2W80_A_D" "1BGX_HL_T" "2WPT_A_B" "4LEO_AB_C" "1ATN_A_D" "4B4S_A_B" "3CQC_A_B" "2XNS_B_D" "2VOH_A_B" "4U0Q_A_B" "3CX6_A_B" "5W2B_HL_A" "5CZX_HL_A" "2XQR_A_B" "4GLA_A_D" "3V96_A_B")
chains1=("D" "C" "E" "A" "A" "J,K" "E" "A" "A" "B" "D" "B" "B" "G" "A" "A" "B" "H,L" "U" "A" "B" "D" "B" "E" "A" "B" "A" "A" "B" "B" "E" "A" "A" "A" "A,B" "B" "P" "A" "L" "B" "H,L" "A" "B" "B" "A" "A" "M" "D,C" "B" "A" "B" "H,L" "A" "B" "B" "C" "G" "B" "A" "B" "A" "B" "G" "A" "A" "C" "A" "N" "A" "A" "A,B" "I" "B" "A" "B" "C" "A" "B" "H,L" "B" "A" "A" "H" "A" "P" "I" "B" "A" "A" "B" "A" "A" "A" "H,L" "B" "D" "A" "C" "A" "A" "B" "A" "A" "A" "A" "B" "A" "B" "A" "I" "B,C" "A" "D" "K,O" "B" "A" "B" "B" "A" "B" "E" "A" "B" "A" "B" "H,L" "B" "B" "Q" "A" "E,F" "A" "H,L" "A" "B" "A" "A" "B" "B" "B" "E" "E" "I" "A" "Q" "B" "D" "A" "A" "A" "A,B,C,D" "D" "A" "B" "A" "A" "H,L" "L" "B,C" "A" "B" "A" "C" "B" "A" "A" "C" "A" "S" "A" "A" "B" "X" "A" "D" "A" "H,L" "C" "A" "A" "B" "B" "A" "A" "D" "H,L" "B" "C" "A" "A" "A" "B" "A" "B" "A" "A" "A" "A" "A" "B")
chains2=("A" "A,B" "F" "H,L" "B" "E" "H,L" "H,L" "B" "A" "A" "A" "A" "J,L" "B" "B,C" "A" "A" "A" "B" "A,C" "A" "A" "I" "B" "A" "H,L" "B" "A" "A" "A" "B" "D" "B" "C,F" "A" "A" "B" "H" "C" "A" "C" "A" "A" "B" "B" "A,B,C" "B" "A" "B" "I,M" "T" "H,L" "A" "A" "A" "A" "A" "C,B" "A" "D" "A" "H,L" "D" "B" "A" "B" "H,L" "B" "B" "C" "E" "A" "B" "A" "A" "B" "I" "A" "I,M" "D" "B" "A" "E" "A" "A" "A" "B" "B" "A" "H,L" "K" "B" "A" "A" "A" "B" "T" "C" "B" "A" "B" "J" "E" "D" "A" "B" "A" "B" "L,H" "A" "C" "A" "D" "A" "B,C" "A" "A" "B" "A" "I" "B" "A" "D" "A" "C" "A" "A" "S" "B" "D" "B" "A" "B" "A" "B" "H,L" "A" "A" "A" "I" "D" "H,L" "B" "K,M" "A" "A" "B" "B" "B" "E" "A" "C" "A" "B" "B" "E" "N" "A" "B" "A" "B" "B,A" "A" "E" "E,H" "A,B" "L,H" "Q" "B" "B" "A" "A,B" "C" "A" "B" "A" "A" "H,L" "B" "A" "A" "B" "B" "A" "T" "A" "A,B" "D" "B" "B" "D" "B" "A" "B" "H,L" "H,L" "B" "D" "A")
mut_res=("28D" "61C" "103E" "2077A" "47A" "2J" "391E" "300A" "44A" "82B" "237D" "136B" "701B" "33G" "96A" "46A" "54B" "99H" "29U" "57A" "496B" "57D" "1311B" "213E" "38A" "91B" "107A" "155A" "162B" "136B" "276E" "108A" "116A" "262A" "33B" "102B" "79P" "40A" "134L" "133B" "99H" "101A" "183B" "1292B" "256A" "230A" "113M" "58D" "67B" "295A" "246B" "104H" "67A" "48B" "881B" "48C" "106G" "43B" "122A" "217B" "30A" "87B" "200G" "45A" "52A" "409C" "328A" "417N" "421A" "113A" "101A" "34I" "50B" "20A" "132B" "873C" "83A" "48B" "52H" "207B" "306A" "72A" "99H" "53A" "81P" "34I" "213B" "230A" "692A" "34B" "68A" "49A" "498A" "58H" "623B" "69D" "56A" "124C" "131A" "35A" "464B" "397A" "363A" "205A" "185A" "592B" "167A" "67B" "44A" "199I" "21B" "27A" "36D" "103K" "157B" "635A" "460B" "202B" "450A" "22B" "149E" "338A" "54B" "6A" "141B" "31H" "673B" "1314B" "44Q" "384A" "57E" "401A" "99H" "265A" "412B" "38A" "111A" "1284B" "41B" "29B" "213E" "94E" "347I" "58A" "17Q" "626B" "1822D" "1540A" "70A" "68A" "20B" "196D" "233A" "21B" "182A" "213A" "94L" "109L" "105B" "177A" "1956B" "58A" "798C" "218B" "99A" "433A" "231C" "18A" "242S" "41A" "655A" "866B" "336X" "95A" "109D" "662A" "31H" "307C" "205A" "142A" "980B" "122B" "191A" "563A" "149D" "58L" "98B" "156C" "43A" "74A" "881A" "72B" "44A" "26B" "280A" "676A" "1470A" "308A" "109A" "214B")

for i in {0..200}
do
    srun /PATH_TO_ROSETTA/source/bin/rosetta_scripts.default.linuxiccrelease -parser:protocol recovery.xml -ignore_unrecognized_res -out:file:score_only recover_val.sc -s ${pdb_id[$i]}.pdb -parser:script_vars c1=${chains1[$i]} c2=${chains2[$i]} r=${mut_res[$i]} -out:no_nstruct_label -mute core.scoring.sc.ShapeIdentityCalculator -in:file:native ${pdb_id[$i]}.pdb
done
    
