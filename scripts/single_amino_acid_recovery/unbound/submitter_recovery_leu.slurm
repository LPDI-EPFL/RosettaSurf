#!/bin/bash
#SBATCH --nodes 1
#SBATCH --ntasks-per-node 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 8192
#SBATCH --time 24:00:00
#SBATCH --partition serial
#SBATCH --output=./leu.%A_%a.out
#SBATCH --error=./leu.%A_%a.err

pdb_id=("4A1U_A_B" "5F3B_AB_C" "5K8Q_A_B" "3S9D_B_A" "2OZA_B_A" "3FSH_B_C" "1C9P_A_B" "2MLZ_B_A" "4TNW_IO_D" "2GWW_A_B" "3ZU7_A_B" "5J28_A_C" "3CQC_A_B" "4RAU_ED_F" "4CT0_A_B" "3CQG_A_B" "4PBV_A_C" "3KLS_A_X" "5XMH_DC_B" "1Y3D_E_I" "2RF9_A_C" "3P71_T_C" "2IH3_AB_C" "4V2C_A_B" "4V0N_D_C" "2HSQ_A_B" "3P71_T_C" "3ZET_A_B" "2V3B_A_B" "1H9D_A_B" "3OL2_A_B" "1T01_A_B" "4NQW_A_B" "1AFV_KM_B" "3LIZ_HL_A" "1TMQ_A_B" "3Q9U_A_C" "3TU3_A_B" "3VLB_A_B" "4RAU_ED_F" "2A6D_L_H" "3MJ7_A_B" "4MHJ_L_H" "5EE5_A_B" "3H8K_A_B" "5INB_A_B" "2I3S_A_B" "5SZH_A_B" "4WEN_A_B" "5F3X_A_B" "4DOQ_A_B" "4XOI_A_B" "4BKX_A_B" "5TH9_HL_A" "2VLP_A_B" "5HPS_A_B" "2MZD_A_B" "2CMR_HL_A" "2Y5B_A_B" "5D1L_A_B" "2I32_A_E" "4PAS_A_B" "2NZ1_X_Y" "3KW5_A_B" "4C5G_A_B" "4MI8_A_C" "1R0R_E_I" "2MNU_A_B" "3VEP_X_D" "2EFH_A_B" "1FMO_E_I" "3BP8_AB_C" "4BD9_A_B" "1PJM_A_B" "2WG3_A_C" "2KWO_B_A" "4DH2_A_B" "1ZHI_A_B" "4YOC_A_C" "1HCF_AB_X" "3K6G_A_D" "5FB8_BA_C" "4NM3_A_B" "4Q5U_A_C" "4M6B_A_C" "3TNF_A_B" "3DVU_A_C" "1SYQ_A_B" "4B1Y_B_M" "1YQV_HL_Y" "2MJ5_A_B" "1F5R_A_I" "3UYP_A_B" "4JZJ_HL_C" "1XQH_A_B" "4I6L_A_B" "4DJ9_A_B" "5XMH_DC_B" "3OJM_A_B" "2A5T_A_B" "3N00_A_B" "4NZW_A_B" "3QBV_A_B" "2O8V_A_B" "1SHZ_A_C" "4MWF_HL_C" "4C7N_A_B" "1GL0_E_I" "2I9B_E_A" "1OGY_A_B" "4V0M_F_E" "4HFF_A_B" "5EB1_A_B" "3C66_A_C" "3K1R_A_B" "2FJU_B_A" "5DJT_A_B" "3WDG_A_B" "2V52_B_M" "3P57_IJ_P" "4Z5R_BA_N" "2MBB_A_B" "3U9P_KM_C" "3DI3_A_B" "3ZYJ_A_B" "2Z3R_A_B" "4AG2_A_C" "3V6Z_AB_F" "4YPI_C_G" "4PC0_A_C" "3TAC_A_B" "2VOG_A_B" "3WRY_A_C" "4FQ0_B_C" "3G9W_A_D" "4OFY_A_D" "1J7V_L_R" "3PNR_A_B" "2F31_A_B" "3TL8_A_B" "3DOE_A_B" "2WP3_T_O" "3MCA_A_B" "3R85_A_E" "3O40_A_B" "3MA9_HL_A" "2MJ5_A_B" "2AST_A_B" "4M6B_A_C" "3PVM_A_B" "5DJT_A_B" "4OFY_A_D" "4ZGQ_A_B" "5GLH_A_B" "5CZF_A_D" "3LEV_L_H" "2J7P_A_D" "5D93_CB_A" "3OAK_A_D" "3DVU_A_C" "4G6J_HL_A" "2W8B_A_H" "1PPE_E_I" "2LUH_A_B" "5JSB_A_B" "1P2C_AB_C" "3W9E_AB_C" "2N2H_A_B" "3DXC_A_B" "5LRW_A_B" "2AW2_A_B" "2QNA_A_B" "2MV7_A_B" "4CU4_A_B" "5G1X_A_B" "4ZGM_A_B" "5DJU_B_A" "1UUG_A_B" "2C1M_A_B" "4QRP_K_L" "2Z8V_A_D" "2OZA_B_A" "4PQT_A_B" "5D1Q_CD_E" "3WQB_A_B" "3GC3_A_B" "1USU_A_B" "3F1P_A_B" "4APF_A_B" "4LAD_A_B" "2W8B_A_H" "4APF_A_B" "4GAF_B_A" "3OJM_A_B" "5J8H_A_B" "2H7V_A_C" "2A7U_A_B" "3LEV_L_H" "3R9A_AC_B" "4YIQ_A_B")
chains1=("B" "C" "B" "A" "A" "C" "A" "A" "I,O" "A" "B" "C" "B" "E,D" "B" "B" "A" "X" "D,C" "E" "A" "T" "C" "A" "D" "B" "T" "A" "A" "B" "B" "A" "A" "B" "H,L" "A" "C" "A" "A" "E,D" "H" "B" "H" "A" "B" "B" "A" "A" "A" "A" "B" "A" "B" "H,L" "A" "A" "A" "A" "A" "B" "A" "B" "X" "A" "A" "C" "E" "A" "X" "B" "E" "A,B" "B" "A" "A" "A" "B" "B" "C" "A,B" "D" "C" "B" "C" "C" "B" "C" "B" "M" "H,L" "A" "A" "A" "H,L" "B" "B" "B" "B" "A" "B" "A" "B" "B" "A" "C" "H,L" "B" "I" "E" "B" "E" "B" "B" "A" "A" "A" "B" "A" "B" "I,J" "N" "A" "K,M" "A" "B" "A" "C" "F" "C" "A" "B" "A" "C" "B" "A" "D" "L" "B" "B" "B" "B" "T" "A" "A" "B" "A" "B" "B" "C" "B" "A" "D" "A" "B" "D" "H" "D" "A" "D" "A" "H,L" "H" "I" "A" "A" "A,B" "C" "A" "A" "B" "A" "B" "B" "A" "B" "B" "A" "B" "A" "L" "D" "A" "B" "E" "A" "B" "B" "A" "B" "B" "A" "A" "A" "A" "A" "A" "B" "L" "B" "A")
chains2=("A" "A,B" "A" "B" "B" "B" "B" "B" "D" "B" "A" "A" "A" "F" "A" "A" "C" "A" "B" "I" "C" "C" "A,B" "B" "C" "A" "C" "B" "B" "A" "A" "B" "B" "K,M" "A" "B" "A" "B" "B" "F" "L" "A" "L" "B" "A" "A" "B" "B" "B" "B" "A" "B" "A" "A" "B" "B" "B" "H,L" "B" "A" "E" "A" "Y" "B" "B" "A" "I" "B" "D" "A" "I" "C" "A" "B" "C" "B" "A" "A" "A" "X" "A" "B,A" "A" "A" "A" "A" "A" "A" "B" "Y" "B" "I" "B" "C" "A" "A" "A" "D,C" "B" "A" "B" "A" "A" "B" "A" "C" "A" "E" "A" "A" "F" "A" "A" "C" "B" "B" "A" "B" "M" "P" "B,A" "B" "C" "B" "A" "B" "A" "A,B" "G" "C" "A" "B" "A" "C" "D" "A" "R" "A" "A" "A" "A" "O" "B" "E" "A" "H,L" "A" "A" "A" "A" "B" "A" "B" "A" "A" "L" "A" "C,B" "A" "C" "A" "A" "E" "B" "B" "C" "A,B" "B" "B" "A" "B" "A" "A" "B" "A" "A" "B" "A" "B" "K" "A" "B" "A" "C,D" "B" "A" "A" "B" "A" "A" "H" "B" "B" "B" "B" "C" "A" "H" "A,C" "B")
mut_res=("94B" "85C" "613B" "15A" "72A" "589C" "99A" "226A" "50I" "123A" "119B" "512C" "938B" "104E" "1164B" "976B" "53A" "146X" "53D" "126E" "909A" "245T" "49C" "215A" "41D" "577B" "307T" "53A" "373A" "64B" "80B" "108A" "177A" "83B" "94L" "150A" "36C" "23A" "323A" "103E" "132H" "39B" "143H" "149A" "589B" "399B" "102A" "667A" "62A" "153A" "74B" "69A" "161B" "30H" "33A" "720A" "63A" "203A" "429A" "139B" "61A" "816B" "273X" "32A" "665A" "122C" "96E" "67A" "43X" "28B" "198E" "146A" "6B" "876A" "44A" "331A" "65B" "504B" "853C" "33B" "308D" "53C" "396B" "413C" "601C" "428B" "116C" "615B" "519M" "52H" "73A" "99A" "4A" "101H" "369B" "8B" "2080B" "314B" "150A" "264B" "606A" "91B" "1337B" "241A" "35C" "53H" "28B" "29I" "40E" "21B" "100E" "70B" "87B" "507A" "100A" "67A" "10B" "184A" "171B" "66I" "153N" "78A" "94M" "89A" "193B" "52A" "30C" "126F" "255C" "31A" "956B" "52A" "1098C" "132B" "356A" "62D" "46L" "309B" "9B" "342B" "119B" "22T" "512A" "130A" "20B" "35A" "954B" "2104B" "615C" "404B" "404A" "107D" "136A" "6B" "5D" "141H" "46D" "38A" "259D" "78A" "100H" "156H" "17I" "82A" "235A" "352B" "25C" "223A" "612A" "8B" "123A" "47B" "879B" "560A" "61B" "32B" "422A" "25B" "489A" "190L" "89D" "382A" "73B" "345E" "515A" "13B" "66B" "239A" "66B" "589B" "268A" "125A" "6A" "18A" "48A" "67A" "75B" "135L" "609B" "96A")

for i in {0..200}
do
    srun /PATH_TO_ROSETTA/source/bin/rosetta_scripts.default.linuxiccrelease -parser:protocol recovery.xml -ignore_unrecognized_res -out:file:score_only recover_leu.sc -s ${pdb_id[$i]}.pdb -parser:script_vars c1=${chains1[$i]} c2=${chains2[$i]} r=${mut_res[$i]} -out:no_nstruct_label -mute core.scoring.sc.ShapeIdentityCalculator -in:file:native ${pdb_id[$i]}.pdb
done
    
