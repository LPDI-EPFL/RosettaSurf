#!/bin/bash
#SBATCH --nodes 1
#SBATCH --ntasks-per-node 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 8192
#SBATCH --time 48:00:00
#SBATCH --partition serial
#SBATCH --output=./thr.%A_%a.out
#SBATCH --error=./thr.%A_%a.err

pdb_id=("5J4A_A_B" "3U9Z_A_C" "3QHT_A_C" "4ONS_A_B" "4PC0_A_C" "4RS1_B_A" "1Y34_E_I" "4XWJ_A_B" "1JIW_P_I" "3AU4_A_B" "1Y64_A_B" "3BGF_BC_A" "4LSU_HL_G" "5BN5_A_B" "5K8Q_A_B" "5AYS_A_C" "3G6J_E_F" "4ZI2_A_C" "4YPG_BA_C" "1WDW_BD_A" "4HGK_A_D" "3BN3_A_B" "1CGI_E_I" "4N7Z_A_B" "4B4S_A_B" "1T44_G_A" "3BN3_A_B" "1BVN_P_T" "4ZK9_A_B" "3ZKQ_A_D" "2JEL_HL_P" "3BH6_A_B" "4ZRP_A_C" "5IXD_A_B" "3ZRZ_A_C" "5KVF_HL_E" "1SMF_E_I" "3HMX_LH_AB" "1FE8_HL_A" "4B1Y_B_M" "4U6V_HL_A" "3DI2_A_B" "4RAU_ED_F" "1HEZ_BA_E" "4U97_A_B" "4C2B_A_B" "2EFH_A_B" "2R0L_HL_A" "4PEQ_A_B" "5USL_BC_A" "5TIH_HL_A" "4F2M_CD_F" "2HRK_A_B" "3W9E_AB_C" "4ZGQ_A_B" "5LBS_HL_A" "5KVG_HL_E" "1MAH_A_F" "5VEB_AB_X" "3DOE_A_B" "5BO1_IM_A" "1VEU_A_B" "5EE5_A_B" "1TM1_E_I" "4KVN_HL_A" "1PJM_A_B" "6BCK_HL_G" "1E3U_A_C" "1G0V_A_B" "2LWW_A_B" "1A2Y_BA_C" "5TE7_HL_G" "5D1M_A_B" "3SJH_A_B" "1JK9_B_A" "4RGO_HL_S" "5FCU_HL_G" "1GL0_E_I" "4CT0_A_B" "5BV7_HL_A" "1KXV_A_C" "1FQJ_A_B" "3DXC_A_B" "1BKD_R_S" "1DPJ_A_B" "2A6D_L_H" "3MJ7_A_B" "2VE7_A_C" "1LW6_E_I" "2WO2_A_B" "1T44_G_A" "1M27_AB_C" "1TO1_E_I" "2B2X_HL_A" "1M5N_S_Q" "5JQ6_HL_A" "6B0H_BA_J" "3C9A_B_D" "4QLP_A_B" "4MSM_A_B" "1Y34_E_I" "5CUS_HL_A" "1K4C_AB_C" "2JBY_A_B" "5SZJ_A_B" "3IXS_A_B" "4WV1_BA_C" "1I9R_HL_ABC" "1H1V_A_G" "4CMH_BC_A" "4K1R_A_B" "5JYL_A_B" "2CFH_A_C" "4HJ0_PQ_A" "3KYI_A_B" "4I18_HL_C" "3ZYI_A_B" "5JYL_A_B" "2PTC_E_I" "4LVN_CB_A" "4P5T_A_B" "4DJ9_A_B" "3BRV_A_B" "4B1V_B_N" "4HX3_BD_A" "5BW7_A_B" "3RKD_DC_B" "1XD3_A_B" "2FD6_HL_U" "1TDQ_A_B" "4RWY_HL_A" "4ZGM_A_B" "4DKE_IM_B" "1DE4_AB_CF" "4U0Q_A_B" "4H88_HL_A" "2EFD_A_B" "5KVG_HL_E" "1E96_A_B" "5F9W_HL_G" "2JKI_A_S" "1BKD_R_S" "1SYQ_A_B" "3CH5_A_B" "2F31_A_B" "3TT1_HL_B" "3C9A_B_D" "1Y3B_E_I" "3BN9_FE_A" "4JPV_HL_G" "2B4J_AB_C" "2ADF_HL_A" "1GHQ_A_B" "2OOR_AB_C" "3QLU_A_C" "1XT9_A_B" "4GH7_A_B" "2QNA_A_B" "4JB9_HL_G" "2WO2_A_B" "5DOB_A_B" "3L9J_C_T" "6AOD_BA_C" "1F51_AB_E" "2GWW_A_B" "4MJS_A_B" "5D93_CB_A" "4PLJ_DC_B" "2Z8V_A_D" "2Y8T_A_B" "1TQB_BC_A" "2XQY_GL_A" "3RGV_A_B" "2V6X_A_B" "2L14_A_B" "3WKT_A_C" "1ZTX_HL_E" "5FB8_BA_C" "2XPX_A_B" "5VL7_HL_B" "3KUD_A_B" "4F38_A_B" "4JDT_HL_G" "3G04_BA_C" "1EGJ_HL_A" "4QCI_HL_C" "3CPH_G_A" "2MV7_A_B" "2DD8_H_L" "1K93_A_D" "4D9Q_ED_B" "1FJ1_DC_E" "2M0G_A_B" "1R6Q_A_C" "4PQT_A_B" "4QXA_A_B" "4PGJ_A_B" "5DC4_A_B" "2JBY_A_B" "2I9B_E_A")
chains1=("A" "A" "A" "B" "C" "A" "E" "B" "P" "B" "A" "B,C" "G" "A" "A" "C" "E" "C" "B,A" "B,D" "A" "A" "E" "A" "A" "G" "B" "T" "B" "D" "H,L" "A" "C" "A" "A" "H,L" "I" "A,B" "H,L" "M" "H,L" "B" "F" "E" "B" "B" "A" "A" "B" "A" "H,L" "C,D" "B" "A,B" "B" "A" "H,L" "A" "A,B" "B" "I,M" "A" "A" "I" "H,L" "B" "G" "C" "A" "A" "B,A" "H,L" "A" "B" "A" "H,L" "G" "I" "B" "H,L" "C" "A" "B" "S" "A" "L" "A" "C" "I" "A" "G" "C" "E" "H,L" "Q" "A" "J" "B" "A" "A" "I" "H,L" "C" "A" "A" "A" "B,A" "A,B,C" "G" "A" "A" "B" "A" "P,Q" "A" "C" "A" "A" "I" "C,B" "B" "A" "A" "B" "B,D" "B" "B" "B" "U" "B" "H,L" "A" "I,M" "A,B" "B" "H,L" "A" "H,L" "A" "G" "A" "S" "A" "A" "B" "H,L" "D" "E" "F,E" "G" "A,B" "H,L" "B" "A,B" "A" "A" "B" "A" "G" "B" "A" "T" "B,A" "A,B" "A" "A" "A" "B" "A" "A" "B,C" "G,L" "B" "A" "A" "A" "H,L" "B,A" "B" "H,L" "B" "B" "G" "C" "H,L" "H,L" "A" "A" "H" "A" "E,D" "D,C" "B" "A" "A" "A" "B" "B" "B" "E")
chains2=("B" "C" "C" "A" "A" "B" "I" "A" "I" "A" "B" "A" "H,L" "B" "B" "A" "F" "A" "C" "A" "D" "B" "I" "B" "B" "A" "A" "P" "A" "A" "P" "B" "A" "B" "C" "E" "E" "L,H" "A" "B" "A" "A" "E,D" "B,A" "A" "A" "B" "H,L" "A" "B,C" "A" "F" "A" "C" "A" "H,L" "E" "F" "X" "A" "A" "B" "B" "E" "A" "A" "H,L" "A" "B" "B" "C" "G" "B" "A" "B" "S" "H,L" "E" "A" "A" "A" "B" "A" "R" "B" "H" "B" "A" "E" "B" "A" "A,B" "I" "A" "S" "H,L" "B,A" "D" "B" "B" "E" "A" "A,B" "B" "B" "B" "C" "H,L" "A" "B,C" "B" "A" "C" "A" "B" "H,L" "B" "B" "E" "A" "A" "B" "B" "N" "A" "A" "D,C" "A" "H,L" "A" "A" "B" "B" "C,F" "A" "A" "B" "E" "B" "H,L" "S" "R" "B" "B" "A" "B" "B" "I" "A" "H,L" "C" "A" "A" "C" "C" "B" "A" "B" "H,L" "A" "B" "C" "C" "E" "B" "B" "C,B" "D,C" "D" "B" "A" "A" "A" "B" "B" "C" "E" "C" "A" "B" "A" "A" "H,L" "B,A" "A" "C" "G" "B" "L" "D" "B" "E" "A" "C" "B" "B" "A" "A" "A" "A")
mut_res=("271A" "148A" "43A" "120B" "677C" "39A" "220E" "16B" "173P" "1443B" "351A" "58B" "278G" "51A" "70A" "55C" "94E" "51C" "32A" "14B" "236A" "300A" "151E" "606A" "82A" "154G" "38B" "855T" "45B" "194D" "31H" "31A" "149C" "236A" "105A" "93L" "10I" "54A" "93L" "501M" "103H" "104B" "38F" "836E" "345B" "240B" "228A" "92A" "60B" "34A" "53L" "96D" "57B" "57B" "471B" "315A" "31L" "75A" "28A" "116B" "28I" "100A" "160A" "58I" "76L" "322B" "455G" "230C" "242A" "395A" "53A" "30H" "70A" "33B" "152A" "73H" "50G" "18I" "1145B" "59H" "56C" "178A" "686B" "828S" "111A" "178L" "64A" "106C" "58I" "104A" "105G" "97C" "220E" "33H" "77Q" "459A" "109J" "410B" "27A" "319A" "55I" "70L" "61C" "47A" "5A" "250A" "32B" "251A" "483G" "114A" "316A" "59B" "28A" "28P" "52A" "56C" "62A" "32A" "11I" "70B" "134B" "8A" "726A" "351B" "34B" "350B" "476B" "7B" "267U" "95B" "94L" "35A" "31M" "77A" "29B" "93L" "228A" "28H" "161A" "283G" "87A" "935S" "8A" "42A" "3B" "30H" "57D" "220E" "98F" "278G" "174A" "55H" "87B" "169A" "60A" "65A" "1351B" "770A" "278G" "96B" "87A" "72T" "69A" "87A" "61A" "69A" "148A" "552B" "186A" "201A" "96B" "30G" "98B" "24A" "2106A" "664A" "93L" "125B" "70B" "31L" "57B" "142B" "455G" "104C" "57H" "91L" "86A" "542A" "96H" "502A" "55E" "53C" "450B" "81A" "316A" "39A" "47B" "37B" "70B" "46E")

for i in {0..200}
do
    srun /PATH_TO_ROSETTA/source/bin/rosetta_scripts.default.linuxiccrelease -parser:protocol recovery.xml -ignore_unrecognized_res -out:file:score_only recover_thr.sc -s ${pdb_id[$i]}.pdb -parser:script_vars c1=${chains1[$i]} c2=${chains2[$i]} r=${mut_res[$i]} -out:no_nstruct_label -mute core.scoring.sc.ShapeIdentityCalculator -in:file:native ${pdb_id[$i]}.pdb -mute all
done
    
