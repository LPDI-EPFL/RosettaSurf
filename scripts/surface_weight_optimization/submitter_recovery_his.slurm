#!/bin/bash
#SBATCH --nodes 1
#SBATCH --ntasks-per-node 1
#SBATCH --cpus-per-task 1
#SBATCH --mem 8192
#SBATCH --time 48:00:00
#SBATCH --partition serial
#SBATCH --output=./his.%A_%a.out
#SBATCH --error=./his.%A_%a.err

pdb_id=("4WV1_BA_C" "1G9M_HL_G" "3O6B_A_B" "1ADQ_HL_A" "5E6P_A_B" "1J2J_A_B" "3BX7_A_C" "4BFI_A_B" "4HKX_AB_E" "4KVN_HL_A" "1ZLI_A_B" "3OSL_A_B" "5D70_HL_A" "5D7L_A_B" "5F4E_A_B" "4EIZ_A_D" "4RWT_A_D" "4FQ0_B_C" "4Y5Y_DE_F" "4BKX_A_B" "2LEH_A_B" "5AYR_A_B" "3L33_A_E" "1AVX_A_B" "3P92_A_E" "4W6Y_A_B" "2XBB_A_C" "3TG1_A_B" "4NOO_A_B" "3MCA_A_B" "2LXM_A_B" "4AYI_A_D" "4M0W_A_B" "1KKL_ABC_H" "5T5F_HL_A" "4JCV_ADBC_E" "1C9P_A_B" "4Z80_A_C" "4FQI_HL_ABEFCD" "1Z3G_IM_B" "4CVW_A_C" "4OII_HL_A" "3EOA_LH_I" "1G9I_E_I" "4DZV_A_B" "5DUP_HL_A" "1CBW_ABC_D" "4DOQ_A_B" "2IY1_A_B" "5TRU_HL_C" "4BYF_C_D" "4C7N_A_B" "2X2D_D_C" "3TNF_A_B" "1FY8_E_I" "4AL8_HL_C" "3MCA_A_B" "2FTL_E_I" "3RT0_A_C" "4PQT_A_B" "1EAW_A_B" "3OJ2_A_C" "4LW4_AB_C" "2LXM_A_B" "5LRW_A_B" "2MJ5_A_B" "1PVH_A_B" "2LWW_A_B" "4RWS_A_C" "3KJ2_A_B" "5TZ2_HL_C" "2NYY_DC_A" "2ABZ_B_E" "1EGJ_HL_A" "1F7Z_A_I" "4XLW_A_B" "5VEB_AB_X" "3P9W_A_B" "2PTT_A_B" "3HI6_XY_B" "2IDO_A_B" "3GB8_A_B" "1NVU_Q_S" "3C66_A_C" "4HCP_A_B" "3TAC_A_B" "3LAQ_A_U" "3RZW_D_A" "1MHP_XY_B" "4YDJ_HL_G" "3OJM_A_B" "3LMS_A_B" "3V6O_CE_A" "1Z92_A_B" "3BDY_HL_V" "1F5R_A_I" "1AXI_A_B" "5L8J_A_B" "3SUA_A_D" "3UIR_A_C" "4PEQ_A_B" "3C66_A_C" "4DZU_A_B" "3N0P_A_B" "1ES0_A_B" "3T04_A_D" "2J88_HL_A" "2V4Z_A_B" "4D0N_A_B" "4MHJ_L_H" "2WFX_A_B" "2M86_A_B" "3S35_HL_X" "2MTA_HL_A" "5F3B_AB_C" "3E2K_A_D" "4AP2_A_B" "3OHM_A_B" "5DOB_A_B" "3N06_A_B" "4PJ2_A_D" "2R9P_A_E" "3OUW_A_B" "1EGJ_HL_A" "1XT9_A_B" "3ZO0_A_B" "3QBQ_A_B" "3HO5_B_H" "1YC0_A_I" "3P30_HL_A" "1FFW_A_B" "1OP9_A_B" "4XLW_A_B" "4RE1_A_D" "5EG3_A_B" "1AVX_A_B" "1TH1_A_C" "5FZT_A_B" "2Y5B_A_B" "1GCQ_B_C" "1ATN_A_D" "5CTR_A_C" "5CXB_A_B" "2G81_E_I" "4F9L_A_B" "2J0T_A_D" "4JRA_A_D" "3IA3_A_D" "3TAC_A_B" "2M5B_A_B" "2OZA_B_A" "1B2S_A_D" "4ZRP_A_C" "3EGG_A_C" "3VI4_FE_B" "2M04_A_B" "3HO5_B_H" "5DUR_HL_C" "3OUX_A_B" "2MJ5_A_B" "2PMS_A_C" "1O9A_A_B" "2W81_A_D" "3KJ0_A_B" "2W80_A_D" "6AOD_BA_C" "2M5B_A_B" "2WG3_A_C" "5D1L_A_B" "4UEM_A_B" "5WI9_HL_A" "2QHO_A_B" "3Q9U_A_C" "1CGI_E_I" "5DUR_HL_C" "2Y5B_A_B" "2FDB_M_P" "4LGP_A_B" "1RV6_VW_X" "3TAC_A_B" "4HCN_A_B" "3QLU_A_C" "4B1X_B_M" "1QFW_IM_AB" "5ABV_A_B" "1C9T_A_G" "2J0T_A_D" "4NZR_HL_M" "5B71_BA_E" "3K2M_A_D" "5F3X_A_B" "5LWY_HL_A" "3ZYI_A_B" "3UX9_A_B" "4XWJ_A_B" "3MA2_D_C" "4CT0_A_B" "3GI9_HL_C" "2VOI_A_B" "1GLA_G_F")
chains1=("C" "H,L" "B" "A" "B" "A" "A" "B" "A,B" "A" "A" "A" "A" "B" "B" "A" "D" "C" "F" "B" "A" "B" "A" "A" "A" "A" "C" "A" "B" "B" "A" "A" "A" "A,B,C" "A" "A,D,B,C" "B" "A" "A,B,E,F,C,D" "I,M" "C" "A" "I" "E" "A" "H,L" "A,B,C" "A" "A" "C" "D" "A" "C" "B" "E" "H,L" "A" "E" "A" "B" "A" "C" "A,B" "A" "B" "B" "B" "A" "C" "A" "H,L" "A" "B" "A" "A" "A" "A,B" "B" "B" "B" "A" "A" "Q" "A" "A" "B" "A" "D" "B" "H,L" "B" "A" "C,E" "B" "V" "A" "A" "A" "D" "A" "A" "A" "A" "A" "B" "A" "A" "A" "B" "L" "A" "B" "X" "A" "A,B" "D" "A" "B" "A" "B" "D" "A" "A" "A" "A" "A" "A" "H" "A" "A" "B" "B" "B" "A" "B" "A" "A" "B" "B" "C" "D" "C" "A" "E" "A" "A" "D" "D" "A" "B" "B" "A" "A" "C" "F,E" "A" "H" "H,L" "A" "A" "C" "B" "D" "A" "D" "C" "A" "A" "B" "A" "H,L" "A" "C" "E" "H,L" "A" "P" "B" "X" "A" "B" "A" "B" "I,M" "A" "A" "A" "H,L" "E" "A" "A" "H,L" "A" "A" "B" "D" "B" "H,L" "B" "F")
chains2=("B,A" "G" "A" "H,L" "A" "B" "C" "A" "E" "H,L" "B" "B" "H,L" "A" "A" "D" "A" "B" "D,E" "A" "B" "A" "E" "B" "E" "B" "A" "B" "A" "A" "B" "D" "B" "H" "H,L" "E" "A" "C" "H,L" "B" "A" "H,L" "L,H" "I" "B" "A" "D" "B" "B" "H,L" "C" "B" "D" "A" "I" "C" "B" "I" "C" "A" "B" "A" "C" "B" "A" "A" "A" "B" "A" "B" "C" "D,C" "E" "H,L" "I" "B" "X" "A" "A" "X,Y" "B" "B" "S" "C" "B" "A" "U" "A" "X,Y" "G" "A" "B" "A" "A" "H,L" "I" "B" "B" "A" "C" "B" "C" "B" "B" "A" "D" "H,L" "B" "A" "H" "B" "A" "H,L" "H,L" "C" "A" "B" "A" "B" "A" "A" "E" "B" "H,L" "B" "B" "B" "B" "I" "H,L" "A" "A" "A" "D" "A" "B" "C" "A" "A" "B" "A" "A" "B" "I" "B" "D" "A" "A" "B" "A" "A" "D" "C" "A" "B" "B" "B" "C" "B" "B" "A" "A" "A" "B" "A" "B,A" "B" "C" "A" "B" "A" "B" "A" "I" "C" "B" "M" "A" "V,W" "B" "A" "C" "M" "A,B" "B" "G" "D" "M" "B,A" "D" "B" "A" "B" "B" "A" "C" "A" "C" "A" "G")
mut_res=("210C" "59H" "767B" "433A" "102B" "80A" "47A" "52B" "52A" "34A" "196A" "310A" "87A" "13B" "65B" "149A" "272D" "138C" "153F" "33B" "120A" "87B" "57A" "57A" "57A" "88A" "68C" "126A" "79B" "251B" "19A" "337A" "273A" "140A" "119A" "31D" "32B" "316A" "38A" "54I" "17C" "293A" "201I" "57E" "19A" "112H" "57B" "57A" "529A" "4C" "108D" "48A" "126C" "528B" "40E" "91L" "508A" "57E" "245A" "68B" "40A" "287C" "338A" "153A" "68B" "923B" "16B" "362A" "6C" "224A" "105H" "1064A" "196B" "395A" "40A" "425A" "32A" "100B" "42B" "264B" "49A" "558A" "27Q" "502A" "211A" "984B" "88A" "35D" "288B" "99H" "287B" "196A" "103C" "120B" "90V" "57A" "21A" "201A" "1838D" "603A" "119A" "482A" "19A" "180A" "6B" "219A" "141A" "213A" "2012B" "34L" "181A" "161B" "267X" "95A" "91B" "148D" "174A" "865B" "104A" "188B" "93D" "57A" "260A" "367A" "102A" "433A" "224A" "180H" "447A" "640A" "181B" "78B" "64B" "404A" "714B" "40A" "219A" "475B" "144B" "656C" "44D" "130C" "409A" "57E" "122A" "218A" "564D" "103D" "120A" "89B" "228B" "102A" "154A" "450C" "31E" "113A" "182H" "54H" "260A" "68A" "186C" "27B" "184D" "224A" "184D" "413C" "99A" "135A" "168B" "289A" "106H" "68A" "40C" "57E" "58H" "515A" "2287P" "31B" "223X" "287A" "68B" "89A" "173B" "294M" "111A" "57A" "222A" "98H" "72E" "192A" "116A" "30L" "275A" "34A" "15B" "201D" "1193B" "101H" "89B" "90F")

for i in {0..200}
do
    srun /PATH_TO_ROSETTA/source/bin/rosetta_scripts.default.linuxiccrelease -parser:protocol recovery.xml -ignore_unrecognized_res -out:file:score_only recover_his.sc -s ${pdb_id[$i]}.pdb -parser:script_vars c1=${chains1[$i]} c2=${chains2[$i]} r=${mut_res[$i]} -out:no_nstruct_label -mute core.scoring.sc.ShapeIdentityCalculator -in:file:native ${pdb_id[$i]}.pdb -mute all
done
    
